<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.carsale.mapper.PurchaseOrderMapper">

    <select id="selectOrderPage" resultType="com.carsale.entity.PurchaseOrder">
        SELECT
        po.*,
        m.manufacturer_name AS manufacturerName,
        u.real_name AS operatorName
        FROM purchase_order po
        LEFT JOIN manufacturer m ON po.manufacturer_id = m.manufacturer_id
        LEFT JOIN system_user u ON po.operator_id = u.user_id
        <where>
            <if test="status != null and status != ''">
                AND po.status = #{status}
            </if>
        </where>
        ORDER BY po.create_time DESC
    </select>

    <select id="selectOrderDetails" resultType="java.util.Map">
        SELECT
            pod.detail_id,
            pod.model_id,
            cm.model_name,
            pod.quantity,
            pod.unit_price,
            pod.subtotal
        FROM purchase_order_detail pod
                 LEFT JOIN car_model cm ON pod.model_id = cm.model_id
        WHERE pod.order_id = #{orderId}
    </select>

</mapper>